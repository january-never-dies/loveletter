<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Sticker Board</title>
  <style>
    html,
    body {
      margin: 0;
      min-height: 100vh;
      background: #bcbabc;
      overflow-y: auto;
      overflow-x: hidden;
    }

    * {
      box-sizing: border-box;
    }

    .frame {
      width: min(100vw, calc(100vh * (390/844)));
      aspect-ratio: 390/844;
      margin: auto;
      position: relative;
      overflow: hidden;
      background: #bcbabc;
    }

    .bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      user-select: none;
      pointer-events: none;
    }

    .sticker {
      position: absolute;
      transform-origin: center center;
      user-select: none;
      -webkit-user-drag: none;
      cursor: pointer;
      transition: transform .12s ease, opacity .2s ease;
      will-change: transform;
    }

    .sticker:active {
      transform: scale(0.98) rotate(var(--rot, 0deg));
    }

    /* ===== Modal ===== */
    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .55);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 9999;
    }

    .overlay.open {
      display: flex;
    }

    .modal {
      width: min(560px, 100%);
      max-height: min(80vh, 720px);
      background: #fff;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 20px 80px rgba(0, 0, 0, .35);
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", sans-serif;
    }

    .modalHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 12px 14px;
      border-bottom: 1px solid rgba(0, 0, 0, .08);
    }

    .modalTitle {
      font-weight: 900;
      font-size: 14px;
      letter-spacing: .2px;
    }

    .closeBtn {
      border: 0;
      background: #000;
      color: #fff;
      border-radius: 12px;
      padding: 8px 10px;
      font-weight: 800;
      cursor: pointer;
    }

    .modalBody {
      padding: 14px;
      overflow: auto;
      max-height: calc(min(80vh, 720px) - 54px);
    }

    /* ì½˜í…ì¸  ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    .modalBody img {
      width: 100%;
      height: auto;
      border-radius: 14px;
      display: block;
    }

    .modalBody video {
      width: 100%;
      border-radius: 14px;
      display: block;
      background: #000;
    }

    .caption {
      margin-top: 10px;
      font-size: 13px;
      line-height: 1.5;
      opacity: .85;
      white-space: pre-wrap;
    }

    /* YouTube Responsive wrapper */
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      /* 16:9 */
      height: 0;
      overflow: hidden;
      border-radius: 14px;
      background: #000;
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    .tab-button {
      position: absolute;
      bottom: 10px;
      /* 780px ê¸°ì¤€ 20px -> 390px ê¸°ì¤€ 10px */
      left: 50%;
      transform: translateX(-50%);
      width: 50%;
      /* (780-196)/780 â‰ˆ 74.87% -> reduced to 50% */
      cursor: pointer;
      display: none;
      z-index: 100;
      transition: opacity 0.3s ease;
    }

    .tab-button.show {
      display: block;
      opacity: 1;
    }

    /* ===== Slider for A & D ===== */
    .slider-outer {
      position: relative;
      width: 100%;
      /* 1080/1350(0.8) -> 1/1(1) ë¡œ ë³€ê²½í•˜ì—¬ íŒì—… ë‚´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
      /* st_Aì˜ ì¼€ì´í¬ ì´ë¯¸ì§€(1080x1350)ì— ë§ê²Œ ê°€ë³€ì ìœ¼ë¡œ ì„¤ì •í•˜ê±°ë‚˜ ê¸°ë³¸ ë¹„ìœ¨ ì¡°ì • */
      aspect-ratio: var(--slider-ratio, 1/1);
      overflow: hidden;
      border-radius: 14px;
      background: #fdfdfd;
      touch-action: pan-y;
    }

    .slider-container {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .slide {
      flex: 0 0 100%;
      width: 100%;
      height: 100%;
    }

    .slide img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 0;
      /* ìŠ¬ë¼ì´ë” ë‚´ë¶€ ì´ë¯¸ì§€ëŠ” ì»¨í…Œì´ë„ˆ ë¼ìš´ë”© ë”°ë¦„ */
      display: block;
    }

    /* 3D Flip Card Styles */
    .slide-outer {
      width: 100%;
      height: 100%;
      perspective: 1000px;
      cursor: pointer;
    }

    .slide-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      transform-style: preserve-3d;
    }

    .slide-outer.flipped .slide-inner {
      transform: rotateY(180deg);
    }

    .slide-front,
    .slide-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 14px;
      overflow: hidden;
    }

    .slide-front {
      background: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .slide-front img {
      width: auto;
      height: 45%;
      /* í–¥ìˆ˜ë³‘ í¬ê¸° ì¶•ì†Œ */
      object-fit: contain;
      margin-bottom: 20px;
      filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.05));
    }

    .front-brand {
      font-size: 11px;
      color: #999;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 4px;
    }

    .front-name {
      font-size: 16px;
      font-weight: 700;
      color: #333;
      text-align: center;
      padding: 0 10px;
    }

    .slide-back {
      transform: rotateY(180deg);
      background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px;
      text-align: center;
      box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.05);
      z-index: 1;
    }

    .perfume-tag {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      color: #999;
      margin-bottom: 8px;
    }

    .perfume-name {
      font-size: 22px;
      font-weight: 800;
      color: #222;
      margin-bottom: 12px;
      line-height: 1.2;
    }

    .perfume-divider {
      width: 30px;
      height: 1px;
      background: #000;
      margin-bottom: 16px;
    }

    .perfume-desc {
      font-size: 14px;
      line-height: 1.6;
      color: #555;
      word-break: keep-all;
    }

    .click-tip {
      position: absolute;
      bottom: 20px;
      font-size: 10px;
      color: #aaa;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% {
        opacity: 0.4;
      }

      50% {
        opacity: 1;
      }

      100% {
        opacity: 0.4;
      }
    }

    .nav-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 36px;
      height: 36px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 10;
      border: none;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      font-size: 18px;
    }

    .nav-btn:active {
      background: #fff;
    }

    .prev-btn {
      left: 10px;
    }

    .next-btn {
      right: 10px;
    }

    .dots-container {
      position: absolute;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      z-index: 10;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: background 0.3s;
    }

    .dot.active {
      background: #fff;
    }
  </style>
</head>

<body>

  <div class="frame" id="frame">
    <img class="bg" src="assets/st_bg.png" alt="" fetchpriority="high" decoding="async">

    <!-- ë°°ì¹˜ê°’: st_layout ê¸°ì¤€ -->
    <img class="sticker" data-id="A" src="assets/st_A.png"
      style="left:2.05%; top:19.55%; width:73.08%; --rot:0deg; transform:rotate(0deg);" alt="" decoding="async">
    <img class="sticker" data-id="B" src="assets/st_B.png"
      style="left:22.31%; top:29.74%; width:70.77%; --rot:-24.5deg; transform:rotate(-24.5deg);" alt=""
      decoding="async">
    <img class="sticker" data-id="C" src="assets/st_C.png"
      style="left:3.08%; top:49.05%; width:63.85%; --rot:18.8deg; transform:rotate(18.8deg);" alt="" decoding="async">
    <img class="sticker" data-id="D" src="assets/st_D.png"
      style="left:3.33%; top:73.34%; width:81.79%; --rot:-4.8deg; transform:rotate(-4.8deg);" alt="" decoding="async">

    <!-- Tab Button (initially hidden) -->
    <img id="tabButton" class="tab-button" src="assets/tab_button.png" alt="Next Page">
  </div>

  <!-- Modal -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalHeader">
        <div class="modalTitle" id="modalTitle">Sticker</div>
        <button class="closeBtn" id="closeBtn">Close</button>
      </div>
      <div class="modalBody" id="modalBody"></div>
    </div>
  </div>

  <script>
    (() => {
      const overlay = document.getElementById('overlay');
      const closeBtn = document.getElementById('closeBtn');
      const modalTitle = document.getElementById('modalTitle');
      const modalBody = document.getElementById('modalBody');

      // âœ… ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë¨: ìŠ¤í‹°ì»¤ë³„ë¡œ ë³´ì—¬ì¤„ ì½˜í…ì¸  ì •ì˜
      // - image: ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œ
      // - video: ì˜ìƒ íŒŒì¼ ê²½ë¡œ(mp4 ê¶Œì¥)
      // - html: ììœ ë¡­ê²Œ í…ìŠ¤íŠ¸/ë§í¬ ë“± ë„£ê¸° (ì§§ê²Œ)
      const CONTENT = {
        A: {
          title: "My sweetie loves sweet things.",
          images: ["assets/cake_0.png", "assets/cake_1.png", "assets/cake_2.png"],
          caption: "My sweetie loves sweet things. She's really into strawberry cake these days. Birthday or not, she eats it anyway.",
          ratio: "1/1"
        },
        B: {
          title: "Mellow R&B",
          youtube: "s8fcHQ-SUrE",
          caption: "ì—¬ìœ ë¡œìš´ ì´ì„œì˜ ì—¬ìœ ë¡œìš´ ì•Œì•¤ë¹„ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸.\n\n[Tracklist ğŸ’¿]\n0:00 Bungee - ë°±í˜„\n3:21 Make up - Sam Kim\n6:43 Open Arms - SZA\n9:41 trippinâ€™ - thuy\n12:01 Toronto 2014 - Daniel Caesar\n16:35 Come Around Me - Justin Bieber"
        },
        C: {
          title: "Different rings everyday",
          image: "assets/st_A_ring.gif",
          caption: "ì£¼ì–¼ë¦¬ íŒŒìš°ì¹˜ë¥¼ ë“¤ê³  ë‹¤ë‹ˆë©° ë‚ ë§ˆë‹¤ ë°˜ì§€ë¥¼ ë°”ê¾¸ì–´ ì°©ìš©í•œë‹¤ê³  í•œë‹¤."
        },
        D: {
          title: "The Scent of Memories",
          items: [
            { src: "assets/per_maejong.png", name: "Replica Jazz Club", brand: "Maison Margiela", desc: "ê²¨ìš¸ì— ìì£¼ ì‚¬ìš©í•˜ëŠ” í–¥ìˆ˜ë¡œ, í˜„ì¬ ê±°ì˜ ì„¸ í†µì§¸ ì‚¬ìš© ì¤‘ì´ë‹¤. ì˜ì™¸ë¡œ ì¤‘ì„±ì ì¸ í–¥ìœ¼ë¡œ ëŠê»´ì§„ë‹¤ê³  í•œë‹¤." },
            { src: "assets/per_missdior.png", name: "Miss Dior Blooming Bouquet", brand: "Dior", desc: "ë°ë·” ì´ˆì— ë§ì´ ì‚¬ìš©í–ˆë˜ í–¥ìˆ˜ë¡œ ì–¸ê¸‰í–ˆë‹¤." },
            { src: "assets/per_lipsaeng.png", name: "Libre", brand: "YSL", desc: "í˜„ì„œê°€ ì„¸ í†µì§¸ ì‚¬ìš© ì¤‘ì¸ í–¥ìˆ˜ì™€ í–¥ì´ ë¹„ìŠ·í•´ í•œë™ì•ˆ ìì£¼ ì‚¬ìš©í–ˆë‹¤ê³  í•œë‹¤." },
            { src: "assets/per_ell.png", name: "H24", brand: "Hermes", desc: "í˜„ì„œ í”¼ì…œ ì–´ë¥¸ìŠ¤ëŸ¬ìš´ í–¥ìˆ˜. ì–´ë¥¸ìŠ¤ëŸ¬ìš´(?) ë¶„ìœ„ê¸°ë¥¼ ë‚´ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ë©°, ì´ê²ƒ ì—­ì‹œ ë‘ í†µì§¸ ì‚¬ìš© ì¤‘." },
            { src: "assets/per_rose.png", name: "Portrait of a Lady", brand: "Frederic Malle", desc: "ì‘ë…„ ì—¬ë¦„ ë¼ì´ë¸Œ ë°©ì†¡ì—ì„œ í˜„ì„œê°€ ì§ì ‘ ì†Œê°œí•œ í–¥ìˆ˜. ê³„ì ˆë§ˆë‹¤ í–¥ìˆ˜ë¥¼ ë°”ê¿” ì‚¬ìš©í•œë‹¤ê³  í–ˆì„ ë•Œ, ì´ í–¥ì€ 2025ë…„ ì—¬ë¦„ í–¥ìˆ˜ë¡œ ì–¸ê¸‰ë˜ì—ˆë‹¤." },
            { src: "assets/per_gucci.png", name: "Alchemist's Garden A Floral Verse", brand: "Gucci", desc: "ë¡¤ë¼íŒ”ë£¨ì íŒŒë¦¬ì— ë‹¤ë…€ì˜¤ë©° êµ¬ë§¤í•œ í–¥ìˆ˜ë¼ê³  í•œë‹¤." },
            { src: "assets/per_vio.png", name: "Violet Multi Perfume", brand: "Granhand", desc: "ê½ƒí–¥ì´ ëšœë ·í•œ í–¥ìœ¼ë¡œ, ì˜·ì— ê°€ë³ê²Œ ë¿Œë¦¬ë©´ ì”í–¥ì´ ì¢‹ì•„ ìì£¼ ì‚¬ìš©í•œë‹¤ê³  í•œë‹¤." }
          ],
          caption: "í–¥ìˆ˜ë³‘ì„ í´ë¦­í•´ë³´ì„¸ìš”!"
        },
      };

      // (ì˜µì…˜) ë³´ê³  ë‚˜ì˜¨ ìŠ¤í‹°ì»¤ë¥¼ ìˆ¨ê¸°ê³  ì‹¶ìœ¼ë©´ true
      const HIDE_AFTER_OPEN = true;
      const VISIT_KEY = "visited_stickers_v1";
      const readVisits = () => { try { return JSON.parse(localStorage.getItem(VISIT_KEY) || "{}"); } catch { return {}; } };
      const writeVisits = (v) => localStorage.setItem(VISIT_KEY, JSON.stringify(v));
      const resetVisits = () => { writeVisits({}); location.reload(); };

      // Debug Reset: ë°°ê²½(frame) 5ë²ˆ í´ë¦­ ì‹œ ì´ˆê¸°í™”
      let bgClickCount = 0;
      document.getElementById('frame').addEventListener('click', (e) => {
        if (e.target.id === 'frame') {
          bgClickCount++;
          if (bgClickCount >= 5) resetVisits();
          setTimeout(() => bgClickCount = 0, 2000);
        }
      });

      const stickers = [...document.querySelectorAll('.sticker')];

      const sessionVisited = {};

      function applyVisited() {
        // ë” ì´ìƒ ì´ˆê¸° ë¡œë“œì‹œ ìŠ¤í‹°ì»¤ë¥¼ ìˆ¨ê¸°ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì‚¬ìš©ì ìš”ì²­: "ì²˜ìŒì—ëŠ” ë‹¤ ë³´ì—¬ì•¼ í•¨")
        // ë˜í•œ ì´ˆê¸° ë¡œë“œì‹œ ë²„íŠ¼ì„ ì²´í¬í•˜ì§€ ì•Šì•„ ë§¤ ì„¸ì…˜ë§ˆë‹¤ ìƒˆë¡œ í´ë¦­í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.
      }

      function checkAllVisited() {
        const allIds = stickers.map(el => el.dataset.id);
        const allVisited = allIds.every(id => sessionVisited[id]);

        if (allVisited) {
          const tabBtn = document.getElementById('tabButton');
          if (tabBtn) tabBtn.classList.add('show');
        }
      }

      function openModal(id) {
        const data = CONTENT[id];
        if (!data) {
          modalTitle.textContent = id;
          modalBody.innerHTML = `<div class="caption">ì½˜í…ì¸ ê°€ ì•„ì§ ì—†ìŒ</div>`;
        } else {
          modalTitle.textContent = data.title || id;

          // ì½˜í…ì¸  ë Œë”
          let html = "";
          if (data.items && Array.isArray(data.items)) {
            html += renderSlider(data.items, true);
          } else if (data.images && Array.isArray(data.images)) {
            html += renderSlider(data.images);
          } else if (data.image) {
            html += `<img src="${data.image}" alt="">`;
          }
          if (data.video) {
            html += `<video src="${data.video}" controls playsinline></video>`;
          }
          if (data.youtube) {
            html += `<div class="video-container">
          <iframe src="https://www.youtube-nocookie.com/embed/${data.youtube}?rel=0" title="YouTube video player" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
        </div>`;
          }
          if (data.html) {
            html += data.html;
          }
          if (data.caption) {
            html += `<div class="caption">${escapeHTML(data.caption)}</div>`;
          }
          modalBody.innerHTML = html;

          // ë¹„ìœ¨ ì¡°ì • (ê¸°ë³¸ê°’ 1/1)
          const sliderOuter = modalBody.querySelector('#sliderOuter');
          if (sliderOuter) {
            sliderOuter.style.setProperty('--slider-ratio', data.ratio || '1/1');
          }

          if ((data.images && Array.isArray(data.images)) || (data.items && Array.isArray(data.items))) {
            setupSlider();
          }
        }

        overlay.classList.add('open');
        overlay.setAttribute('aria-hidden', 'false');
        overlay.dataset.activeId = id; // í˜„ì¬ ì—´ë¦° ID ì €ì¥
      }

      function closeModal() {
        const id = overlay.dataset.activeId;
        overlay.classList.remove('open');
        overlay.setAttribute('aria-hidden', 'true');
        modalBody.innerHTML = "";

        // ë°©ë¬¸ ì²˜ë¦¬ ë° ìŠ¤í‹°ì»¤ ìˆ¨ê¸°ê¸°: íŒì—…ì„ 'ë‹«ì„ ë•Œ' ì‚¬ë¼ì§€ë„ë¡ ìˆ˜ì •
        if (HIDE_AFTER_OPEN && id) {
          sessionVisited[id] = true;
          const v = readVisits();
          v[id] = true;
          writeVisits(v);

          // í˜„ì¬ ì„¸ì…˜ì—ì„œ ì¦‰ì‹œ ìˆ¨ê¹€ ì²˜ë¦¬
          const el = stickers.find(s => s.dataset.id === id);
          if (el) {
            el.style.opacity = "0";
            el.style.pointerEvents = "none";
          }

          checkAllVisited();
        }
        overlay.dataset.activeId = "";
      }

      stickers.forEach(el => {
        el.addEventListener('click', () => openModal(el.dataset.id));
      });

      const tabBtn = document.getElementById('tabButton');
      if (tabBtn) {
        tabBtn.addEventListener('click', () => {
          window.location.href = 'letter.html';
        });
      }

      closeBtn.addEventListener('click', closeModal);
      overlay.addEventListener('click', (e) => {
        if (e.target === overlay) closeModal(); // ë°”ê¹¥ í´ë¦­ ë‹«ê¸°
      });
      window.addEventListener('keydown', (e) => {
        if (e.key === "Escape" && overlay.classList.contains('open')) closeModal();
      });

      function renderSlider(data, isInteractive = false) {
        let slides = data.map((item, i) => {
          const src = typeof item === 'string' ? item : item.src;
          if (isInteractive) {
            return `
              <div class="slide">
                <div class="slide-outer" onclick="this.classList.toggle('flipped')">
                  <div class="slide-inner">
                    <div class="slide-front">
                      <img src="${src}" alt="">
                      <div class="front-brand">${item.brand}</div>
                      <div class="front-name">${item.name}</div>
                      <div class="click-tip">Tap to reveal info</div>
                    </div>
                    <div class="slide-back">
                      <div class="perfume-desc">${item.desc}</div>
                    </div>
                  </div>
                </div>
              </div>`;
          }
          return `<div class="slide"><img src="${src}" alt=""></div>`;
        }).join("");

        let dots = data.map((_, i) => `<div class="dot ${i === 0 ? 'active' : ''}" data-idx="${i}"></div>`).join("");
        return `
          <div class="slider-outer" id="sliderOuter">
            <div class="slider-container" id="sliderContainer">
              ${slides}
            </div>
            <button class="nav-btn prev-btn">â®</button>
            <button class="nav-btn next-btn">â¯</button>
            <div class="dots-container">
              ${dots}
            </div>
          </div>
        `;
      }

      function setupSlider() {
        const container = document.getElementById('sliderContainer');
        const outer = document.getElementById('sliderOuter');
        const dots = outer.querySelectorAll('.dot');
        const prevBtn = outer.querySelector('.prev-btn');
        const nextBtn = outer.querySelector('.next-btn');
        let currentIndex = 0;
        const totalSlides = dots.length;

        function updateSlider() {
          container.style.transform = `translateX(-${currentIndex * 100}%)`;
          dots.forEach((dot, i) => dot.classList.toggle('active', i === currentIndex));
        }

        function goNext() {
          currentIndex = (currentIndex + 1) % totalSlides;
          updateSlider();
        }

        function goPrev() {
          currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
          updateSlider();
        }

        nextBtn.addEventListener('click', goNext);
        prevBtn.addEventListener('click', goPrev);

        dots.forEach(dot => {
          dot.addEventListener('click', () => {
            currentIndex = parseInt(dot.dataset.idx);
            updateSlider();
          });
        });

        // Swipe (Mobile)
        let startX = 0;
        outer.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
        }, { passive: true });

        outer.addEventListener('touchend', (e) => {
          let endX = e.changedTouches[0].clientX;
          let diff = startX - endX;
          if (Math.abs(diff) > 50) {
            if (diff > 0) goNext();
            else goPrev();
          }
        }, { passive: true });
      }

      function escapeHTML(s) {
        return String(s)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;");
      }

      applyVisited();
    })();
  </script>

</body>

</html>